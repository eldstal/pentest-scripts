#!/bin/env -S jq -r -f
#
# npm audit --json | jq -r -f npm_audit_summarize.jq
# Prints findings as severity, package name, advisory URL

[ .advisories[] ]
| sort_by(.cvss.score) | reverse
| .[] | { severity: .severity, url: .url, module_name: .module_name }

# Optionally, latex-ify it
# Comment this line out to get JSON output
| "\\item (" + .severity + ") " + .module_name + " \\url{" + .url + "}"

